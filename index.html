<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å°è¦ƒ & å°æ€¡ Â· åœ£è¯çºªå¿µæ—¥</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Noto Sans SC', sans-serif;
      /* è‡ªå®šä¹‰å›¾ç‰‡èƒŒæ™¯ - è¯·æ›¿æ¢ä¸ºä½ çš„å›¾ç‰‡URL */
      background: url('png/å…‰é‡.png') no-repeat center center fixed;
      background-size: cover;
      color: #f0f0f0;
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
    }

    /* èƒŒæ™¯é®ç½©ï¼Œç¡®ä¿æ–‡å­—å¯è¯»æ€§ */
    body::before {
      content: '';
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(10, 15, 30, 0.5);
      z-index: 0;
      pointer-events: none;
    }

    /* === æµ®å±é›ªèŠ±æ•ˆæœ === */
    #floatSnowCanvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    /* === éœ“è™¹æ–‡å­—æ•ˆæœ === */
    .neon-text {
      text-shadow: 
        0 0 5px #fff,
        0 0 10px #fff,
        0 0 20px #ff6b6b,
        0 0 30px #ff6b6b,
        0 0 40px #ff6b6b;
      animation: neonPulse 1.5s ease-in-out infinite alternate;
    }

    @keyframes neonPulse {
      from {
        text-shadow: 
          0 0 5px #fff,
          0 0 10px #fff,
          0 0 20px #ff6b6b,
          0 0 30px #ff6b6b,
          0 0 40px #ff6b6b;
      }
      to {
        text-shadow: 
          0 0 10px #fff,
          0 0 20px #ffd700,
          0 0 30px #ffd700,
          0 0 40px #ffd700,
          0 0 50px #ffd700;
      }
    }

    /* === ç«‹ä½“å¡ç‰‡æ•ˆæœ === */
    .card-3d {
      transform-style: preserve-3d;
      transition: transform 0.5s ease;
    }

    .card-3d:hover {
      transform: rotateY(10deg) rotateX(5deg) translateZ(10px);
    }

    /* === æ‰“å­—æœºæ•ˆæœ === */
    .typewriter {
      overflow: hidden;
      border-right: 3px solid #ff6b6b;
      white-space: nowrap;
      animation: typing 3.5s steps(40, end), blink-caret 0.75s step-end infinite;
    }

    @keyframes typing {
      from { width: 0 }
      to { width: 100% }
    }

    @keyframes blink-caret {
      from, to { border-color: transparent }
      50% { border-color: #ff6b6b }
    }

    /* === è¿›åº¦æ¡æ ·å¼ === */
    .progress-container {
      width: 100%;
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      margin: 15px 0;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #ff6b6b, #ffd700);
      border-radius: 4px;
      transition: width 1s ease;
      position: relative;
      overflow: hidden;
    }

    .progress-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      width: 20px;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      animation: progressShine 2s infinite;
    }

    @keyframes progressShine {
      0% { left: -20px; }
      100% { left: 100%; }
    }

    /* === æ—¶é—´çº¿æ ·å¼ === */
    .timeline {
      position: relative;
      padding: 20px 0;
    }

    .timeline::before {
      content: '';
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 2px;
      height: 100%;
      background: linear-gradient(to bottom, #ff6b6b, #ffd700);
    }

    .timeline-item {
      position: relative;
      margin: 30px 0;
      width: 45%;
      padding: 15px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      border: 1px solid rgba(255, 215, 0, 0.3);
    }

    .timeline-item:nth-child(odd) {
      margin-left: auto;
    }

    .timeline-item:nth-child(even) {
      margin-right: auto;
    }

    .timeline-date {
      color: #ffd700;
      font-size: 0.9em;
      margin-bottom: 5px;
    }

    /* === å®¹å™¨æ ·å¼ - æé«˜é€æ˜åº¦ === */
    .container {
      max-width: 1100px;
      margin: 0 auto;
      display: flex;
      gap: 30px;
      padding: 30px;
      background: rgba(20, 25, 40, 0.7); /* æé«˜é€æ˜åº¦ */
      border-radius: 28px;
      box-shadow: 
        0 12px 50px rgba(139, 0, 0, 0.2),
        0 0 0 1px rgba(255, 215, 0, 0.2);
      animation: fadeIn 1s cubic-bezier(0.23, 1, 0.32, 1);
      position: relative;
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* æ·»åŠ å®¹å™¨å‘å…‰è¾¹ç¼˜æ•ˆæœ */
    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 28px;
      padding: 2px;
      background: linear-gradient(135deg, 
        rgba(255, 107, 107, 0.3), 
        rgba(255, 215, 0, 0.2), 
        rgba(255, 107, 107, 0.3));
      -webkit-mask: 
        linear-gradient(#fff 0 0) content-box, 
        linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      pointer-events: none;
      z-index: 1;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* === å·¦ä¾§è¾¹æ  === */
    .left-side {
      width: 220px;
      text-align: center;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 28px;
      background: rgba(30, 35, 50, 0.6); /* æé«˜é€æ˜åº¦ */
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.2);
    }

    /* === å³ä¾§è¾¹æ  === */
    .right-side {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 25px;
      background: rgba(30, 35, 50, 0.6); /* æé«˜é€æ˜åº¦ */
      border-radius: 20px;
      padding: 25px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .person-card {
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      background: rgba(40, 45, 60, 0.6); /* æé«˜é€æ˜åº¦ */
      border-radius: 15px;
      padding: 15px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.4s ease;
    }

    .person-card:hover {
      background: rgba(50, 55, 70, 0.7);
      transform: translateY(-5px);
      box-shadow: 
        0 10px 25px rgba(0, 0, 0, 0.3),
        0 0 20px rgba(255, 107, 107, 0.2);
    }

    .avatar {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid #ffd700;
      box-shadow: 
        0 0 25px rgba(255, 215, 0, 0.6),
        inset 0 0 20px rgba(255, 255, 255, 0.1);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      cursor: pointer;
      position: relative;
      filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.3));
    }

    .avatar:hover {
      transform: scale(1.08) rotate(3deg);
      box-shadow: 
        0 0 35px rgba(255, 107, 107, 0.8),
        inset 0 0 25px rgba(255, 255, 255, 0.2);
      filter: drop-shadow(0 0 12px rgba(255, 107, 107, 0.4));
    }

    .name {
      margin-top: 10px;
      font-weight: 700;
      font-size: 1.3em;
      color: #ff6b6b;
      text-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
      background: linear-gradient(90deg, #ff6b6b, #ffd700);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .role {
      font-size: 0.9em;
      color: rgba(255, 255, 255, 0.9);
      margin-bottom: 4px;
    }

    .tagline {
      font-size: 1em;
      color: #ffd700;
      margin-top: 15px;
      font-style: italic;
      text-align: center;
      text-shadow: 0 0 8px rgba(255, 215, 0, 0.4);
      background: rgba(255, 215, 0, 0.15);
      padding: 10px 15px;
      border-radius: 12px;
      border: 1px solid rgba(255, 215, 0, 0.3);
    }

    h1 {
      text-align: center;
      font-weight: 700;
      font-size: 2em;
      color: transparent;
      background: linear-gradient(90deg, #ffd700, #ff6b6b, #ffd700);
      background-size: 300% 300%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: 2px;
      animation: gradientShift 6s ease infinite;
      padding-bottom: 12px;
      position: relative;
      background-color: rgba(255, 255, 255, 0.08);
      padding: 15px;
      border-radius: 15px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .timer-container {
      display: flex;
      justify-content: center;
      gap: 12px;
    }

    .flip-unit {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 70px;
    }

    .flip-digit {
      font-size: 2.4em;
      font-weight: bold;
      background: linear-gradient(to bottom, #ff6b6b, #c0392b);
      padding: 14px;
      border-radius: 14px;
      width: 100%;
      text-align: center;
      color: white;
      text-shadow: 0 2px 4px rgba(0,0,0,0.4);
      box-shadow: 
        0 6px 15px rgba(0,0,0,0.4),
        inset 0 2px 0 rgba(255,255,255,0.2);
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .flip-digit::after {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(rgba(255,255,255,0.1), transparent);
      pointer-events: none;
    }

    .flip-label {
      margin-top: 8px;
      font-size: 0.95em;
      color: #ffd700;
      font-weight: 500;
    }

    .buttons {
      display: flex;
      justify-content: center;
      gap: 16px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 12px 26px;
      border: none;
      border-radius: 32px;
      background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 
        0 5px 15px rgba(255, 107, 107, 0.45),
        0 0 0 1px rgba(255, 255, 255, 0.2);
      position: relative;
      overflow: hidden;
      font-family: inherit;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0; left: -100%;
      width: 100%; height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.6s;
    }

    .btn:hover {
      transform: translateY(-3px) scale(1.04);
      box-shadow: 
        0 8px 20px rgba(255, 107, 107, 0.7),
        0 0 0 1px rgba(255, 255, 255, 0.3);
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn.active {
      background: linear-gradient(135deg, #ffd700, #ffaa00);
      color: #1a1a2e;
      box-shadow: 
        0 5px 20px rgba(255, 215, 0, 0.5),
        0 0 0 1px rgba(255, 255, 255, 0.3);
    }

    .music-btn {
      position: fixed;
      bottom: 25px;
      right: 25px;
      width: 55px;
      height: 55px;
      border-radius: 50%;
      background: rgba(30, 30, 40, 0.8);
      border: 2px solid #ffd700;
      color: #ffd700;
      font-size: 1.3em;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 2000;
      transition: all 0.3s;
      box-shadow: 
        0 4px 12px rgba(0,0,0,0.3),
        0 0 0 1px rgba(255, 255, 255, 0.2);
    }

    .music-btn:hover {
      background: rgba(255, 215, 0, 0.3);
      transform: scale(1.12) rotate(5deg);
      box-shadow: 
        0 6px 18px rgba(255, 215, 0, 0.4),
        0 0 0 1px rgba(255, 255, 255, 0.3);
    }

    /* === å†…å®¹åŒºåŸŸ === */
    .section {
      display: none;
      padding: 24px;
      background: rgba(25, 30, 45, 0.7); /* æé«˜é€æ˜åº¦ */
      border-radius: 20px;
      box-shadow: 
        0 6px 20px rgba(0,0,0,0.25);
      animation: slideIn 0.5s cubic-bezier(0.23, 1, 0.32, 1);
      border: 1px solid rgba(255, 215, 0, 0.25);
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(15px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .section.active {
      display: block;
    }

    textarea, input[type="text"] {
      width: 100%;
      padding: 14px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 14px;
      background: rgba(20, 25, 40, 0.7);
      color: white;
      resize: vertical;
      margin-bottom: 14px;
      font-family: inherit;
      transition: all 0.3s ease;
    }

    textarea:focus, input[type="text"]:focus {
      outline: none;
      border-color: #ff6b6b;
      box-shadow: 0 0 0 2px rgba(255, 107, 107, 0.3);
      background: rgba(20, 25, 40, 0.9);
    }

    .photo-wall {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
      gap: 12px;
    }

    .photo-item {
      border-radius: 12px;
      overflow: hidden;
      aspect-ratio: 1;
      box-shadow: 0 4px 12px rgba(0,0,0,0.45);
      transition: all 0.3s ease;
      cursor: pointer;
      border: 2px solid rgba(255, 255, 255, 0.2);
      background: rgba(255, 255, 255, 0.1);
    }

    .photo-item:hover {
      transform: scale(1.06) rotate(1deg);
      box-shadow: 
        0 6px 18px rgba(255, 107, 107, 0.5),
        0 0 0 2px rgba(255, 107, 107, 0.3);
      border-color: rgba(255, 107, 107, 0.4);
    }

    .photo-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    footer {
      text-align: center;
      margin-top: auto;
      padding-top: 24px;
      color: rgba(255, 255, 255, 0.8);
      font-size: 1em;
      letter-spacing: 1px;
      background: rgba(30, 35, 50, 0.6);
      border-radius: 15px;
      padding: 15px;
      margin-top: 20px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    #confettiCanvas, #heartCanvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 5000;
    }

    /* ç»˜ç”»æ¿ */
    #paintCanvas {
      background: rgba(15, 20, 30, 0.7);
      border-radius: 14px;
      display: block;
      margin-bottom: 18px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      cursor: crosshair;
      width: 100%;
      touch-action: none;
    }

    .color-palette {
      display: flex;
      gap: 10px;
      margin-bottom: 12px;
    }

    .color-dot {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid white;
      box-shadow: 
        0 2px 6px rgba(0,0,0,0.4),
        0 0 0 1px rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
    }

    .color-dot.active {
      transform: scale(1.2);
      box-shadow: 
        0 0 0 3px white,
        0 0 10px rgba(255, 255, 255, 0.5);
    }

    /* æƒ…è¯è½®æ’­ */
    .love-quote {
      text-align: center;
      font-style: italic;
      color: #ffd700;
      margin: 15px 0;
      min-height: 2em;
      opacity: 0;
      animation: fadeQuote 3s ease-in-out infinite;
      background: rgba(255, 215, 0, 0.15);
      padding: 10px;
      border-radius: 10px;
      border: 1px solid rgba(255, 215, 0, 0.3);
    }

    @keyframes fadeQuote {
      0%, 100% { opacity: 0; }
      10%, 90% { opacity: 1; }
    }

    /* æ¥ç¤¼ç‰©æ¸¸æˆ */
    #gameArea {
      position: relative;
      width: 100%;
      height: 300px;
      background: rgba(10, 15, 30, 0.7);
      border-radius: 16px;
      overflow: hidden;
      margin-top: 15px;
      border: 1px dashed rgba(255, 107, 107, 0.6);
      box-shadow: 
        inset 0 0 20px rgba(0, 0, 0, 0.3),
        0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .gift {
      position: absolute;
      font-size: 24px;
      animation: fall linear forwards;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }

    @keyframes fall {
      to { transform: translateY(300px); }
    }

    .basket {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 32px;
      z-index: 10;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }

    /* æ–°å¢ï¼šæ¸¸æˆæ§åˆ¶æŒ‰é’® */
    .game-controls {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 15px;
    }

    .control-btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
      color: white;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.3),
        0 0 0 1px rgba(255, 255, 255, 0.2);
    }

    .control-btn.left-btn {
      background: linear-gradient(135deg, #4ecdc4, #1dd1a1);
    }

    .control-btn.right-btn {
      background: linear-gradient(135deg, #54a0ff, #2e86de);
    }

    .control-btn:hover {
      transform: scale(1.05);
      box-shadow: 
        0 6px 18px rgba(0, 0, 0, 0.4),
        0 0 0 1px rgba(255, 255, 255, 0.3);
    }

    .control-btn:active {
      transform: scale(0.95);
    }

    /* æ–°å¢ï¼šå›¾ç‰‡æ”¾å¤§æ¨¡æ€æ¡† */
    .image-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      animation: fadeIn 0.3s ease;
    }

    .image-modal.active {
      display: flex;
    }

    .modal-content {
      max-width: 90%;
      max-height: 90%;
      position: relative;
      background: rgba(30, 35, 50, 0.9);
      border-radius: 15px;
      padding: 20px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.4);
    }

    .modal-content img {
      max-width: 100%;
      max-height: 80vh;
      object-fit: contain;
      border-radius: 10px;
      box-shadow: 
        0 0 30px rgba(255, 215, 0, 0.3);
    }

    .close-modal {
      position: absolute;
      top: -40px;
      right: 0;
      background: rgba(255, 107, 107, 0.9);
      border: none;
      color: white;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .close-modal:hover {
      background: #ff6b6b;
      transform: scale(1.1);
      box-shadow: 0 0 15px rgba(255, 107, 107, 0.5);
    }

    .modal-nav {
      position: absolute;
      top: 50%;
      width: 100%;
      display: flex;
      justify-content: space-between;
      transform: translateY(-50%);
      padding: 0 20px;
    }

    .nav-btn {
      background: rgba(255, 215, 0, 0.9);
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .nav-btn:hover {
      background: #ffd700;
      transform: scale(1.1);
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
    }

    /* === æ–°å¢ï¼šç§»åŠ¨ç«¯ä¼˜åŒ– === */
    @media (max-width: 768px) {
      .container {
        flex-direction: column;
        padding: 20px;
        margin: 10px;
        border-radius: 20px;
      }
      
      .left-side, .right-side {
        width: 100%;
      }
      
      .buttons {
        flex-wrap: wrap;
        gap: 10px;
      }
      
      .btn {
        padding: 10px 20px;
        font-size: 0.9em;
      }
    }
  </style>
</head>
<body>

  <!-- æµ®å±é›ªèŠ±æ•ˆæœ -->
  <canvas id="floatSnowCanvas"></canvas>

  <!-- å½©å¸¦å’Œçˆ±å¿ƒç”»å¸ƒ -->
  <canvas id="confettiCanvas"></canvas>
  <canvas id="heartCanvas"></canvas>

  <!-- æ–°å¢ï¼šå›¾ç‰‡æ”¾å¤§æ¨¡æ€æ¡† -->
  <div class="image-modal" id="imageModal">
    <div class="modal-content">
      <button class="close-modal" id="closeModal">Ã—</button>
      <img id="modalImage" src="" alt="æ”¾å¤§å›¾ç‰‡">
      <div class="modal-nav">
        <button class="nav-btn" id="prevBtn">â€¹</button>
        <button class="nav-btn" id="nextBtn">â€º</button>
      </div>
    </div>
  </div>

  <div class="music-btn" id="musicBtn">ğŸ”‡</div>

  <div class="container">
    <div class="left-side">
      <div class="person-card card-3d">
        <div class="role">ğŸ‘¤ ä½ </div>
        <img src="png/xiaoqin.jpg" alt="å°è¦ƒ" class="avatar" id="yourAvatar">
        <div class="name">å°è¦ƒ</div>
      </div>

      <div class="person-card card-3d">
        <div class="role">â¤ï¸ å¥¹</div>
        <img src="png/xiaoyi.jpg" alt="å°æ€¡" class="avatar" id="herAvatar">
        <div class="name">å°æ€¡</div>
      </div>

      <div class="tagline" id="tagline">Merry Christmas Â· ç¬¬?å¤© â¤ï¸</div>
      
      <!-- æ¯æ—¥æƒ…è¯ -->
      <div class="love-quote" id="loveQuote"></div>
    </div>

    <div class="right-side">
      <h1 class="neon-text" id="title">åœ£è¯çºªå¿µæ—¥ Â· ä»Šå¤©æ˜¯æˆ‘ä»¬çš„ç¬¬?å¤©</h1>
      <div class="timer-container" id="timer"></div>

      <div class="buttons">
        <button class="btn" data-section="message">ğŸ’Œ ç•™è¨€æ¿</button>
        <button class="btn" data-section="photos">ğŸ“¸ Love Photo</button>
        <button class="btn" data-section="wishes">âœ¨ å¿ƒæ„¿åˆ—è¡¨</button>
        <button class="btn" data-section="drawingBoard">ğŸ¨ ç»˜ç”»æ¿</button>
        <button class="btn" data-section="game">ğŸ æ¥ç¤¼ç‰©</button>
      </div>

      <!-- ç•™è¨€æ¿ -->
      <div id="message" class="section active">
        <div style="display:flex;gap:10px;margin-bottom:12px;">
          <select id="messageFrom" style="flex:1;padding:10px;border:1px solid rgba(255,255,255,0.3);border-radius:10px;background:rgba(20,20,30,0.7);color:white;">
            <option value="å°è¦ƒ">æˆ‘ (å°è¦ƒ)</option>
            <option value="å°æ€¡">å¥¹ (å°æ€¡)</option>
          </select>
        </div>
        <textarea id="newMessage" placeholder="å†™ä¸‹ä½ çš„åœ£è¯ç¥ç¦..."></textarea>
        <button onclick="addMessage()" class="btn">å‘é€</button>
        <div id="messages"></div>
      </div>

      <!-- ç…§ç‰‡å¢™ -->
      <div id="photos" class="section photo-wall">
        <!-- ä¸ºæ¯ä¸ªå›¾ç‰‡æ·»åŠ data-indexå±æ€§ä»¥ä¾¿è¯†åˆ« -->
        <div class="photo-item" data-index="0"><img src="png/d9f06decdb202a9ba58ec1533b65160.png" alt="çºªå¿µç…§ç‰‡1"></div>
        <div class="photo-item" data-index="1"><img src="png/d2d9ce0dddd61ed6a43ed7c112642e9.jpg" alt="çºªå¿µç…§ç‰‡2"></div>
        <div class="photo-item" data-index="2"><img src="png/cb09995ecff2e04a939a0dc87accd54.jpg" alt="çºªå¿µç…§ç‰‡3"></div>
        <div class="photo-item" data-index="3"><img src="png/c57e59c6fe15353df90e72de87c75fa.jpg" alt="çºªå¿µç…§ç‰‡4"></div>
        <div class="photo-item" data-index="4"><img src="png/bfb9ebd6b90110581b73ea1bb4cb5dd.png" alt="çºªå¿µç…§ç‰‡5"></div>
        <div class="photo-item" data-index="5"><img src="png/67d0c5c6cc38f886103dd452cab506f.jpg" alt="çºªå¿µç…§ç‰‡6"></div>
        <div class="photo-item" data-index="6"><img src="png/0f7dcb86626fd51f4b37ae4ebaa03dd.jpg" alt="çºªå¿µç…§ç‰‡7"></div>
        <div class="photo-item" data-index="7"><img src="png/07e0613aa1862a7fc44f03854b5f65b.jpg" alt="çºªå¿µç…§ç‰‡8"></div>
      </div>

      <!-- å¿ƒæ„¿åˆ—è¡¨ -->
      <div id="wishes" class="section">
        <div class="wish-input" style="display:flex;gap:10px;margin-bottom:15px;">
          <input type="text" id="newWish" placeholder="æ¯”å¦‚ï¼šä¸€èµ·çœ‹æå…‰...">
          <button onclick="addWish()" class="btn">æ·»åŠ </button>
        </div>
        <div id="wishList"></div>
      </div>

      <!-- ç»˜ç”»æ¿ -->
      <div id="drawingBoard" class="section">
        <div class="color-palette" id="colorPalette">
          <!-- é¢œè‰²ç”± JS ç”Ÿæˆ -->
        </div>
        <canvas id="paintCanvas" width="500" height="350"></canvas>
        <button onclick="clearCanvas()" class="btn">æ¸…é™¤ç”»å¸ƒ</button>
      </div>

      <!-- æ¥ç¤¼ç‰©å°æ¸¸æˆ -->
      <div id="game" class="section">
        <p style="text-align:center;color:#ffd700;">ç”¨ â† â†’ æ–¹å‘é”®æˆ–ä¸‹æ–¹æŒ‰é’®æ§åˆ¶ç¯®å­ï¼Œæ¥ä½åœ£è¯ç¤¼ç‰©ï¼</p>
        <div id="gameArea">
          <div class="basket">ğŸ§º</div>
        </div>
        <div style="text-align:center;margin-top:10px;">
          å¾—åˆ†: <span id="score">0</span>
        </div>
        <!-- æ–°å¢ï¼šæ¸¸æˆæ§åˆ¶æŒ‰é’® -->
        <div class="game-controls">
          <button class="control-btn left-btn" id="moveLeft">â†</button>
          <button class="control-btn right-btn" id="moveRight">â†’</button>
        </div>
      </div>

      <footer>Â© 2025 å°è¦ƒ & å°æ€¡ | åœ£è¯å¿«ä¹ï¼Œçˆ±æ„æ°¸å­˜ ğŸ„â¤ï¸</footer>
    </div>
  </div>

  <audio id="bgMusic" preload="none"></audio>
  <audio id="wishSound" src="data:audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGFTb25vdGhlcXVlLm9yZwBURU5DAAAAHQAAA1N3aXRjaCBQbHVzIMKpIE5DSCBTb2Z0d2FyZQBUSVQyAAAABgAAAzIyMzUAVFNTRQAAAA8AAANMyXZmNTcuODMuMTAwAAAAAAAAAAAAAAD/80DEAAAAA0gAAAAATEFNRTMuMTAwVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQsRbAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQMSkAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV" preload="auto"></audio>

  <script>
    // ========== æµ®å±é›ªèŠ±æ•ˆæœ ==========
    const floatSnowCanvas = document.getElementById('floatSnowCanvas');
    const floatSnowCtx = floatSnowCanvas.getContext('2d');
    let floatSnowflakes = [];
    const floatSnowflakeCount = 50; // å‡å°‘é›ªèŠ±æ•°é‡ä»¥æå‡æ€§èƒ½

    function initFloatSnow() {
      floatSnowCanvas.width = window.innerWidth;
      floatSnowCanvas.height = window.innerHeight;
      floatSnowflakes = [];
      for (let i = 0; i < floatSnowflakeCount; i++) {
        floatSnowflakes.push({
          x: Math.random() * floatSnowCanvas.width,
          y: Math.random() * floatSnowCanvas.height,
          radius: Math.random() * 2 + 1,
          speed: Math.random() * 0.5 + 0.2, // æ›´æ…¢çš„é€Ÿåº¦
          drift: Math.random() * 0.2 - 0.1,
          opacity: Math.random() * 0.4 + 0.3
        });
      }
    }

    function animateFloatSnow() {
      floatSnowCtx.clearRect(0, 0, floatSnowCanvas.width, floatSnowCanvas.height);
      floatSnowflakes.forEach(flake => {
        flake.y += flake.speed;
        flake.x += flake.drift;
        if (flake.y > floatSnowCanvas.height) flake.y = -10;
        if (flake.x > floatSnowCanvas.width) flake.x = 0;
        if (flake.x < 0) flake.x = floatSnowCanvas.width;
        floatSnowCtx.beginPath();
        floatSnowCtx.arc(flake.x, flake.y, flake.radius, 0, Math.PI * 2);
        floatSnowCtx.fillStyle = `rgba(255, 255, 255, ${flake.opacity})`;
        floatSnowCtx.fill();
      });
      requestAnimationFrame(animateFloatSnow);
    }

    // ========== æƒ…è¯åº“ ==========
    const loveQuotes = [
      "é‡è§ä½ ï¼Œæ˜¯æˆ‘ä»Šç”Ÿæœ€ç¾çš„æ„å¤–ã€‚",
      "è¾“äº†æ²¡å…³ç³»ï¼Œè·Ÿä½ ä¸€èµ·ç©å°±å¾ˆæœ‰æ„æ€ï¼Œä¸‹æ¬¡å†æ‰“å›æ¥ï¼",
      "å’Œä½ åœ¨ä¸€èµ·çš„æ¯ä¸€ç§’ï¼Œéƒ½å€¼å¾—çè—ã€‚",
      "åœ£è¯è€äººé—®æˆ‘æ„¿æœ›æ˜¯ä»€ä¹ˆï¼Œæˆ‘è¯´ï¼šåªè¦å°æ€¡å¼€å¿ƒã€‚",
      "ä»Šå¤©ä¹Ÿè¾›è‹¦å•¦ï¼Œç›–å¥½è¢«å­ï¼Œä¸è®¸è¸¢è¢«å­å“¦ã€‚æ™šå®‰",
      "ä½ ç¬‘èµ·æ¥çš„æ ·å­ï¼Œæ¯”åœ£è¯æ ‘ä¸Šçš„æ˜Ÿæ˜Ÿè¿˜äº®ã€‚",
      "æœªæ¥çš„æ¯ä¸€å¤©ï¼Œéƒ½æƒ³å’Œä½ ä¸€èµ·è¿‡ã€‚",
      "å¿™äº†ä¸€å¤©æ—©ç‚¹ä¼‘æ¯å§ï¼Œæ™šå®‰ï¼Œæ¢¦é‡Œè§",
      "å‹è°Šæœ€å¥½çš„çŠ¶æ€å¤§æ¦‚å°±æ˜¯ï¼šæˆ‘æ‡‚ä½ çš„å¥‡å¥‡æ€ªæ€ªï¼Œä½ é™ªæˆ‘å¯å¯çˆ±çˆ±ã€‚",
      "å¤©æ°”å˜å‡‰äº†ï¼Œè®°å¾—å¤šç©¿ä»¶è¡£æœï¼Œåˆ«æ„Ÿå†’å•¦ã€‚",
      "ä¸ç®¡é‡åˆ°ä»€ä¹ˆäº‹ï¼Œè®°å¾—ä½ è¿˜æœ‰æˆ‘è¿™ä¸ªç½‘å‹å¯ä»¥éšæ—¶èŠå¤©ã€‚",
      "ä»Šå¤©ä¹Ÿè¦å…ƒæ°”æ»¡æ»¡å‘€ï¼æœ‰ä»€ä¹ˆå¼€å¿ƒçš„äº‹éƒ½å¯ä»¥éšæ—¶åˆ†äº«ç»™æˆ‘ã€‚",
      "æ„Ÿè§‰ä½ ä¸€ç›´åœ¨åŠªåŠ›å˜å¥½ï¼ŒçœŸçš„å¾ˆæ£’ï¼",
      "è°¢è°¢ä½ æ„¿æ„å¬æˆ‘åˆ†äº«é‚£äº›é›¶é›¶ç¢ç¢çš„å°äº‹ï¼Œæœ‰ä½ è¿™ä¸ªæœ‹å‹çœŸå¥½ã€‚"
    ];

    function showRandomQuote() {
      const quote = loveQuotes[Math.floor(Math.random() * loveQuotes.length)];
      document.getElementById('loveQuote').textContent = quote;
    }

    // ========== åŠ¨æ€çºªå¿µæ—¥ ==========
    function updateDaysTogether() {
      const startDate = new Date("November 9, 2025").getTime();
      const now = new Date().getTime();
      let diffTime = now - startDate;

      if (diffTime < 0) {
        document.getElementById('tagline').textContent = `Merry Christmas Â· è¿˜æœªå¼€å§‹ â¤ï¸`;
        document.getElementById('title').textContent = `åœ£è¯çºªå¿µæ—¥ Â· å°šæœªå¼€å§‹`;
        return;
      }

      let daysTogether = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
      document.getElementById('tagline').textContent = `Merry Christmas Â· ç¬¬${daysTogether}å¤© â¤ï¸`;
      document.getElementById('title').textContent = `åœ£è¯çºªå¿µæ—¥ Â· æˆ‘ä»¬çš„ç¬¬${daysTogether}å¤©`;
    }

    // ========== çˆ±å¿ƒç²’å­ï¼ˆç‚¹å‡»ä»»æ„åœ°æ–¹ï¼‰==========
    const heartCanvas = document.getElementById('heartCanvas');
    const heartCtx = heartCanvas.getContext('2d');
    let hearts = [];

    function initHeartCanvas() {
      heartCanvas.width = window.innerWidth;
      heartCanvas.height = window.innerHeight;
    }

    function createHeart(x, y) {
      for (let i = 0; i < 3; i++) { // å‡å°‘çˆ±å¿ƒæ•°é‡
        hearts.push({
          x, y,
          vx: (Math.random() - 0.5) * 3,
          vy: -Math.random() * 2 - 1,
          size: Math.random() * 8 + 6,
          life: 1,
          decay: 0.03
        });
      }
    }

    function animateHearts() {
      heartCtx.clearRect(0, 0, heartCanvas.width, heartCanvas.height);
      for (let i = hearts.length - 1; i >= 0; i--) {
        const h = hearts[i];
        h.x += h.vx;
        h.y += h.vy;
        h.vy += 0.08;
        h.life -= h.decay;
        if (h.life <= 0) {
          hearts.splice(i, 1);
          continue;
        }
        heartCtx.globalAlpha = h.life;
        heartCtx.font = `${h.size}px Arial`;
        heartCtx.fillText('â¤ï¸', h.x, h.y);
      }
      heartCtx.globalAlpha = 1;
      if (hearts.length > 0) requestAnimationFrame(animateHearts);
    }

    document.body.addEventListener('click', (e) => {
      if (!e.target.closest('.container')) {
        createHeart(e.clientX, e.clientY);
        if (hearts.length === 3) animateHearts();
      }
    });

    // ========== å½©å¸¦ï¼ˆä¿ç•™åŸé€»è¾‘ï¼Œç•¥ä½œä¼˜åŒ–ï¼‰==========
    const confettiCanvas = document.getElementById('confettiCanvas');
    const confettiCtx = confettiCanvas.getContext('2d');
    let particles = [];

    function initConfetti() {
      confettiCanvas.width = window.innerWidth;
      confettiCanvas.height = window.innerHeight;
    }

    function createConfetti(x, y) {
      if (particles.length > 80) return; // å‡å°‘æœ€å¤§ç²’å­æ•°
      const colors = ['#ff6b6b', '#ffd700', '#4ecdc4', '#ffbe0b', '#ff9ff3'];
      for (let i = 0; i < 10; i++) { // å‡å°‘æ¯æ¬¡åˆ›å»ºçš„ç²’å­æ•°
        const angle = Math.random() * Math.PI * 2;
        const speed = Math.random() * 150 + 100;
        particles.push({
          x, y,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed,
          radius: Math.random() * 4 + 2,
          color: colors[Math.floor(Math.random() * colors.length)],
          life: 1.0,
          decay: Math.random() * 0.03 + 0.02
        });
      }
    }

    function animateConfetti() {
      confettiCtx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
      for (let i = particles.length - 1; i >= 0; i--) {
        const p = particles[i];
        p.x += p.vx * 0.016;
        p.y += p.vy * 0.016;
        p.vy += 200 * 0.016; // é™ä½é‡åŠ›
        p.life -= p.decay;
        if (p.life <= 0) {
          particles.splice(i, 1);
          continue;
        }
        confettiCtx.globalAlpha = p.life;
        confettiCtx.fillStyle = p.color;
        confettiCtx.beginPath();
        confettiCtx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
        confettiCtx.fill();
      }
      confettiCtx.globalAlpha = 1;
      if (particles.length > 0) requestAnimationFrame(animateConfetti);
    }

    document.querySelectorAll('.avatar').forEach(avatar => {
      avatar.addEventListener('click', (e) => {
        createConfetti(e.clientX, e.clientY);
        if (particles.length <= 10) animateConfetti();
      });
    });

    // ========== éŸ³ä¹ ==========
    const bgMusic = document.getElementById('bgMusic');
    const musicBtn = document.getElementById('musicBtn');
    let isPlaying = false;
    const MUSIC_URL = "http://music.163.com/song/media/outer/url?id=2122667644.mp3";

    musicBtn.addEventListener('click', () => {
      if (isPlaying) {
        bgMusic.pause();
        musicBtn.textContent = 'ğŸ”‡';
        isPlaying = false;
      } else {
        if (!bgMusic.src) bgMusic.src = MUSIC_URL;
        bgMusic.play().then(() => {
          musicBtn.textContent = 'ğŸµ';
          isPlaying = true;
        }).catch(() => alert('è¯·ç‚¹å‡»é¡µé¢ä»»æ„ä½ç½®å¯ç”¨éŸ³é¢‘'));
      }
    });

    // ========== å€’è®¡æ—¶ ==========
    function initTimer() {
      const endDate = new Date("Dec 25, 2025 00:00:00").getTime();
      const units = ['å¤©', 'æ—¶', 'åˆ†', 'ç§’'];
      const container = document.getElementById('timer');
      container.innerHTML = '';
      for (let i = 0; i < 4; i++) {
        const unit = document.createElement('div');
        unit.className = 'flip-unit';
        unit.innerHTML = `<div class="flip-digit" id="digit-${i}">--</div><div class="flip-label">${units[i]}</div>`;
        container.appendChild(unit);
      }
      function update() {
        const now = new Date().getTime();
        let diff = (endDate - now) / 1000;
        if (diff <= 0) {
          document.querySelectorAll('.flip-digit').forEach(el => el.textContent = '00');
          return;
        }
        const days = Math.floor(diff / 86400);
        diff %= 86400;
        const hours = Math.floor(diff / 3600);
        diff %= 3600;
        const minutes = Math.floor(diff / 60);
        const seconds = Math.floor(diff % 60);
        [days, hours, minutes, seconds].forEach((val, i) => {
          document.getElementById(`digit-${i}`).textContent = String(val).padStart(2, '0');
        });
      }
      update();
      setInterval(update, 1000);
    }

    // ========== é¢æ¿åˆ‡æ¢ ==========
    document.querySelectorAll('.btn[data-section]').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById(btn.dataset.section).classList.add('active');
      });
    });

    // ========== ç•™è¨€ & å¿ƒæ„¿ ==========
    function addMessage() {
      const text = document.getElementById('newMessage').value.trim();
      const from = document.getElementById('messageFrom').value;
      if (!text) return;
      const msgs = JSON.parse(localStorage.getItem('loveMessages') || '[]');
      msgs.push({ text, from, time: new Date().toLocaleString('zh-CN') });
      localStorage.setItem('loveMessages', JSON.stringify(msgs));
      renderMessages();
      document.getElementById('newMessage').value = '';
    }

    function renderMessages() {
      const el = document.getElementById('messages');
      const msgs = JSON.parse(localStorage.getItem('loveMessages') || '[]');
      el.innerHTML = msgs.map(m => 
        `<div style="background:rgba(40,45,60,0.8);padding:14px 18px;border-left:5px solid ${m.from==='å°è¦ƒ'?'#ff6b6b':'#4ecdc4'};margin-top:14px;border-radius:0 12px 12px 0;">
          <strong>${m.from}ï¼š</strong>${m.text}<br>
          <span style="font-size:0.85em;color:#aaa;">${m.time}</span>
        </div>`
      ).join('');
    }

    // ========== å¿ƒæ„¿åˆ—è¡¨ ==========
    function addWish() {
      const text = document.getElementById('newWish').value.trim();
      if (!text) return;
      const wishes = JSON.parse(localStorage.getItem('loveWishes') || '[]');
      wishes.push({ text, done: false });
      localStorage.setItem('loveWishes', JSON.stringify(wishes));
      renderWishes();
      document.getElementById('newWish').value = '';
      // æ’­æ”¾éŸ³æ•ˆ
      document.getElementById('wishSound').currentTime = 0;
      document.getElementById('wishSound').play().catch(() => {});
    }

    function renderWishes() {
      const el = document.getElementById('wishList');
      const wishes = JSON.parse(localStorage.getItem('loveWishes') || '[]');
      el.innerHTML = wishes.map((w, i) => `
        <div style="display:flex;align-items:center;gap:12px;padding:12px;background:rgba(30,35,50,0.8);margin-bottom:10px;border-radius:12px;">
          <input type="checkbox" ${w.done ? 'checked' : ''} onchange="toggleWish(${i})" style="transform:scale(1.2);">
          <span style="flex:1;${w.done ? 'text-decoration:line-through;color:#888;' : ''}">${w.text}</span>
          <button onclick="removeWish(${i})" style="background:none;border:none;color:#ff6b6b;cursor:pointer;">âœ–</button>
        </div>
      `).join('');
    }

    function toggleWish(index) {
      const wishes = JSON.parse(localStorage.getItem('loveWishes') || '[]');
      wishes[index].done = !wishes[index].done;
      localStorage.setItem('loveWishes', JSON.stringify(wishes));
      renderWishes();
    }

    function removeWish(index) {
      const wishes = JSON.parse(localStorage.getItem('loveWishes') || '[]');
      wishes.splice(index, 1);
      localStorage.setItem('loveWishes', JSON.stringify(wishes));
      renderWishes();
    }

    // ========== ç»˜ç”»æ¿ä¿®å¤ ==========
    const paintCanvas = document.getElementById('paintCanvas');
    const paintCtx = paintCanvas.getContext('2d');
    let painting = false;
    let currentColor = '#ff6b6b';
    const colors = ['#ff6b6b', '#ffd700', '#4ecdc4', '#ff9ff3', '#1dd1a1', '#54a0ff', '#f368e0', '#ffffff'];

    function initDrawingBoard() {
      // ç¡®ä¿ç”»å¸ƒæœ‰æ­£ç¡®çš„å¤§å°
      const container = paintCanvas.parentElement;
      const containerWidth = container.clientWidth;
      paintCanvas.width = containerWidth - 48; // å‡å»padding
      paintCanvas.height = 350;
      
      // åˆå§‹åŒ–ç”»å¸ƒèƒŒæ™¯
      paintCtx.fillStyle = 'rgba(15, 20, 30, 0.95)';
      paintCtx.fillRect(0, 0, paintCanvas.width, paintCanvas.height);
      
      // åˆ›å»ºé¢œè‰²é€‰æ‹©å™¨
      const palette = document.getElementById('colorPalette');
      palette.innerHTML = '';
      colors.forEach(color => {
        const dot = document.createElement('div');
        dot.className = 'color-dot';
        dot.style.backgroundColor = color;
        if (color === currentColor) dot.classList.add('active');
        dot.addEventListener('click', () => {
          document.querySelectorAll('.color-dot').forEach(d => d.classList.remove('active'));
          dot.classList.add('active');
          currentColor = color;
        });
        palette.appendChild(dot);
      });

      // ä¿®å¤ç»˜ç”»äº‹ä»¶
      function getMousePos(canvas, evt) {
        const rect = canvas.getBoundingClientRect();
        return {
          x: evt.clientX - rect.left,
          y: evt.clientY - rect.top
        };
      }

      function startPaint(e) {
        painting = true;
        const pos = getMousePos(paintCanvas, e);
        paintCtx.beginPath();
        paintCtx.moveTo(pos.x, pos.y);
        paint(e);
      }

      function paint(e) {
        if (!painting) return;
        
        const pos = getMousePos(paintCanvas, e);
        
        paintCtx.lineWidth = 3;
        paintCtx.lineCap = 'round';
        paintCtx.lineJoin = 'round';
        paintCtx.strokeStyle = currentColor;
        
        paintCtx.lineTo(pos.x, pos.y);
        paintCtx.stroke();
        paintCtx.beginPath();
        paintCtx.moveTo(pos.x, pos.y);
      }

      function stopPaint() {
        painting = false;
        paintCtx.beginPath();
      }

      // ç»‘å®šäº‹ä»¶
      paintCanvas.addEventListener('mousedown', startPaint);
      paintCanvas.addEventListener('mouseup', stopPaint);
      paintCanvas.addEventListener('mousemove', paint);
      paintCanvas.addEventListener('mouseleave', stopPaint);

      // è§¦æ‘¸äº‹ä»¶æ”¯æŒ
      paintCanvas.addEventListener('touchstart', (e) => {
        e.preventDefault();
        const touch = e.touches[0];
        const mouseEvent = new MouseEvent('mousedown', {
          clientX: touch.clientX,
          clientY: touch.clientY
        });
        paintCanvas.dispatchEvent(mouseEvent);
      });

      paintCanvas.addEventListener('touchmove', (e) => {
        e.preventDefault();
        const touch = e.touches[0];
        const mouseEvent = new MouseEvent('mousemove', {
          clientX: touch.clientX,
          clientY: touch.clientY
        });
        paintCanvas.dispatchEvent(mouseEvent);
      });

      paintCanvas.addEventListener('touchend', () => {
        const mouseEvent = new MouseEvent('mouseup', {});
        paintCanvas.dispatchEvent(mouseEvent);
      });
    }

    function clearCanvas() {
      paintCtx.fillStyle = 'rgba(15, 20, 30, 0.95)';
      paintCtx.fillRect(0, 0, paintCanvas.width, paintCanvas.height);
    }

    // ========== å›¾ç‰‡æ”¾å¤§é¢„è§ˆåŠŸèƒ½ ==========
    let currentImageIndex = 0;
    const imageItems = document.querySelectorAll('.photo-item');

    function initImagePreview() {
      imageItems.forEach((item, index) => {
        item.addEventListener('click', () => {
          currentImageIndex = index;
          openImageModal();
        });
      });

      // å…³é—­æ¨¡æ€æ¡†
      document.getElementById('closeModal').addEventListener('click', closeImageModal);
      
      // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
      document.getElementById('imageModal').addEventListener('click', (e) => {
        if (e.target.id === 'imageModal') {
          closeImageModal();
        }
      });

      // å¯¼èˆªæŒ‰é’®
      document.getElementById('prevBtn').addEventListener('click', showPrevImage);
      document.getElementById('nextBtn').addEventListener('click', showNextImage);

      // é”®ç›˜å¯¼èˆª
      document.addEventListener('keydown', (e) => {
        if (document.getElementById('imageModal').classList.contains('active')) {
          if (e.key === 'Escape') closeImageModal();
          if (e.key === 'ArrowLeft') showPrevImage();
          if (e.key === 'ArrowRight') showNextImage();
        }
      });
    }

    function openImageModal() {
      const modalImage = document.getElementById('modalImage');
      const clickedImage = imageItems[currentImageIndex].querySelector('img');
      modalImage.src = clickedImage.src;
      modalImage.alt = clickedImage.alt;
      document.getElementById('imageModal').classList.add('active');
    }

    function closeImageModal() {
      document.getElementById('imageModal').classList.remove('active');
    }

    function showPrevImage() {
      currentImageIndex = (currentImageIndex - 1 + imageItems.length) % imageItems.length;
      const modalImage = document.getElementById('modalImage');
      const clickedImage = imageItems[currentImageIndex].querySelector('img');
      modalImage.src = clickedImage.src;
      modalImage.alt = clickedImage.alt;
    }

    function showNextImage() {
      currentImageIndex = (currentImageIndex + 1) % imageItems.length;
      const modalImage = document.getElementById('modalImage');
      const clickedImage = imageItems[currentImageIndex].querySelector('img');
      modalImage.src = clickedImage.src;
      modalImage.alt = clickedImage.alt;
    }

    // ========== æ¥ç¤¼ç‰©æ¸¸æˆï¼ˆæ·»åŠ æŒ‰é’®æ§åˆ¶ï¼‰==========
    let score = 0;
    let basketX = 50;
    let gameRunning = false;
    let giftInterval;

    function initGame() {
      const gameArea = document.getElementById('gameArea');
      gameArea.innerHTML = '<div class="basket">ğŸ§º</div>';
      score = 0;
      document.getElementById('score').textContent = score;
      
      // é”®ç›˜æ§åˆ¶
      document.addEventListener('keydown', (e) => {
        const basket = document.querySelector('.basket');
        if (!basket) return;
        
        if (e.key === 'ArrowLeft' && basketX > 5) {
          basketX -= 15;
        } else if (e.key === 'ArrowRight' && basketX < 95) {
          basketX += 15;
        }
        basket.style.left = `${basketX}%`;
      });

      // æŒ‰é’®æ§åˆ¶
      const moveLeftBtn = document.getElementById('moveLeft');
      const moveRightBtn = document.getElementById('moveRight');

      moveLeftBtn.addEventListener('mousedown', () => {
        moveLeft();
      });

      moveRightBtn.addEventListener('mousedown', () => {
        moveRight();
      });

      // è§¦æ‘¸äº‹ä»¶æ”¯æŒ
      moveLeftBtn.addEventListener('touchstart', (e) => {
        e.preventDefault();
        moveLeft();
      });

      moveRightBtn.addEventListener('touchstart', (e) => {
        e.preventDefault();
        moveRight();
      });
    }

    function moveLeft() {
      const basket = document.querySelector('.basket');
      if (!basket) return;
      
      if (basketX > 5) {
        basketX -= 15;
        basket.style.left = `${basketX}%`;
      }
    }

    function moveRight() {
      const basket = document.querySelector('.basket');
      if (!basket) return;
      
      if (basketX < 95) {
        basketX += 15;
        basket.style.left = `${basketX}%`;
      }
    }

    function startGame() {
      if (gameRunning) return;
      gameRunning = true;
      score = 0;
      document.getElementById('score').textContent = score;
      
      giftInterval = setInterval(createGift, 1200); // é™ä½ç¤¼ç‰©ç”Ÿæˆé¢‘ç‡
      
      // 60ç§’ååœæ­¢æ¸¸æˆ
      setTimeout(() => {
        stopGame();
        alert(`æ¸¸æˆç»“æŸï¼å¾—åˆ†ï¼š${score}`);
      }, 60000);
    }

    function createGift() {
      if (!gameRunning) return;
      
      const gameArea = document.getElementById('gameArea');
      const gift = document.createElement('div');
      gift.className = 'gift';
      gift.textContent = 'ğŸ';
      gift.style.left = `${Math.random() * 90 + 5}%`;
      gift.style.top = '0';
      gift.style.fontSize = '24px';
      gift.style.animation = `fall ${Math.random() * 2 + 2}s linear forwards`;
      
      gameArea.appendChild(gift);
      
      // ç¢°æ’æ£€æµ‹
      const checkCollision = setInterval(() => {
        const giftRect = gift.getBoundingClientRect();
        const basketRect = document.querySelector('.basket').getBoundingClientRect();
        
        if (giftRect.bottom >= basketRect.top && 
            giftRect.right >= basketRect.left && 
            giftRect.left <= basketRect.right) {
          score++;
          document.getElementById('score').textContent = score;
          gift.remove();
          clearInterval(checkCollision);
        }
        
        if (giftRect.top > gameArea.offsetHeight) {
          gift.remove();
          clearInterval(checkCollision);
        }
      }, 50); // é™ä½æ£€æµ‹é¢‘ç‡
      
      // 2.5ç§’åè‡ªåŠ¨ç§»é™¤
      setTimeout(() => {
        if (gift.parentNode) {
          gift.remove();
        }
      }, 2500);
    }

    function stopGame() {
      gameRunning = false;
      clearInterval(giftInterval);
      document.getElementById('gameArea').innerHTML = '<div class="basket">ğŸ§º</div>';
    }

    // === æ–°å¢ï¼šæ—¥æœŸè¿›åº¦æ¡ ===
    function createDateProgress() {
      const startDate = new Date('2025-11-09');
      const endDate = new Date('2025-12-25');
      const today = new Date();
      
      const totalDays = (endDate - startDate) / (1000 * 60 * 60 * 24);
      const passedDays = (today - startDate) / (1000 * 60 * 60 * 24);
      
      let progress = (passedDays / totalDays) * 100;
      if (progress > 100) progress = 100;
      if (progress < 0) progress = 0;
      
      // åœ¨æ ‡é¢˜ä¸‹æ·»åŠ è¿›åº¦æ¡
      const title = document.querySelector('h1');
      if (title) {
        const progressHTML = `
          <div class="progress-container" style="margin-top: 15px; max-width: 400px; margin-left: auto; margin-right: auto;">
            <div class="progress-bar" style="width: ${progress}%;"></div>
          </div>
          <div style="text-align: center; margin-top: 5px; font-size: 0.9em; color: #ffd700;">
            è·ç¦»åœ£è¯è¿˜æœ‰ ${Math.ceil(totalDays - passedDays)} å¤© (${progress.toFixed(1)}%)
          </div>
        `;
        title.insertAdjacentHTML('afterend', progressHTML);
      }
    }

    // === æ–°å¢ï¼šæƒ…ä¾£äº’åŠ¨æŒ‰é’® ===
    function createInteractionButtons() {
      const leftSide = document.querySelector('.left-side');
      if (leftSide) {
        const buttonsHTML = `
          <div style="display: flex; justify-content: center; gap: 10px; margin-top: 15px;">
            <button style="padding: 8px 15px; background: rgba(255, 107, 107, 0.8); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 20px; color: white; cursor: pointer;" onclick="sendVirtualHug()">ğŸ¤— æŠ±æŠ±</button>
            <button style="padding: 8px 15px; background: rgba(255, 215, 0, 0.8); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 20px; color: white; cursor: pointer;" onclick="sendVirtualKiss()">ğŸ˜˜ å¤§å˜´å·´å­</button>
          </div>
        `;
        const tagline = document.getElementById('tagline');
        tagline.insertAdjacentHTML('afterend', buttonsHTML);
      }
    }

    function sendVirtualHug() {
      showNotification('ğŸ¤— å‘é€äº†ä¸€ä¸ªæ¸©æš–çš„æŠ±æŠ±ï¼');
      createHeartParticles();   
    }

    function sendVirtualKiss() {
      showNotification('ğŸ˜˜ å‘é€äº†ä¸€ä¸ªç”œèœœçš„æ¶é¾™å’†å“®ï¼');
      // åœ¨ä¸¤äººå¤´åƒä¹‹é—´åˆ›å»ºçˆ±å¿ƒ
      const yourAvatar = document.getElementById('yourAvatar');
      const herAvatar = document.getElementById('herAvatar');
      
      if (yourAvatar && herAvatar) {
        const rect1 = yourAvatar.getBoundingClientRect();
        const rect2 = herAvatar.getBoundingClientRect();
        
        const startX = rect1.left + rect1.width / 2;
        const startY = rect1.top + rect1.height / 2;
        const endX = rect2.left + rect2.width / 2;
        const endY = rect2.top + rect2.height / 2;
        
        createLoveLine(startX, startY, endX, endY);
      }
    }

    function showNotification(text) {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(255, 107, 107, 0.9);
        color: white;
        padding: 12px 24px;
        border-radius: 25px;
        z-index: 10000;
        animation: fadeInOut 3s ease;
        box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        border: 1px solid rgba(255, 255, 255, 0.3);
      `;
      
      notification.innerHTML = text;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.remove();
      }, 3000);
    }

    function createHeartParticles() {
      const container = document.querySelector('.container');
      const rect = container.getBoundingClientRect();
      
      for (let i = 0; i < 8; i++) {
        setTimeout(() => {
          const x = rect.left + rect.width / 2;
          const y = rect.top + rect.height / 2;
          createHeart(x, y);
          if (hearts.length === 3) animateHearts();
        }, i * 100);
      }
    }

    function createLoveLine(x1, y1, x2, y2) {
      const line = document.createElement('div');
      line.style.cssText = `
        position: fixed;
        top: ${y1}px;
        left: ${x1}px;
        width: 2px;
        height: 2px;
        background: linear-gradient(45deg, #ff6b6b, #ffd700);
        transform-origin: 0 0;
        z-index: 1000;
        pointer-events: none;
      `;
      
      const angle = Math.atan2(y2 - y1, x2 - x1);
      const length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
      
      line.style.transform = `rotate(${angle}rad)`;
      line.style.width = `${length}px`;
      
      document.body.appendChild(line);
      
      // åŠ¨ç”»
      line.animate([
        { opacity: 0, transform: `rotate(${angle}rad) scaleX(0)` },
        { opacity: 1, transform: `rotate(${angle}rad) scaleX(1)` },
        { opacity: 0 }
      ], {
        duration: 1000,
        easing: 'ease-out'
      });
      
      setTimeout(() => line.remove(), 1000);
    }

    // === æ–°å¢ï¼šæ—¥å¤œæ¨¡å¼åˆ‡æ¢ ===
    function createThemeToggle() {
      const musicBtn = document.getElementById('musicBtn');
      const themeBtn = document.createElement('div');
      themeBtn.className = 'music-btn';
      themeBtn.style.right = '90px';
      themeBtn.innerHTML = 'ğŸŒ™';
      themeBtn.title = 'åˆ‡æ¢ä¸»é¢˜';
      
      themeBtn.addEventListener('click', () => {
        document.body.classList.toggle('light-theme');
        if (document.body.classList.contains('light-theme')) {
          themeBtn.innerHTML = 'â˜€ï¸';
        } else {
          themeBtn.innerHTML = 'ğŸŒ™';
        }
      });
      
      document.body.appendChild(themeBtn);
    }

    // ========== é¡µé¢åˆå§‹åŒ– ==========
    function initPage() {
      updateDaysTogether();
      showRandomQuote();
      setInterval(showRandomQuote, 5000); // 5ç§’åˆ‡æ¢ä¸€æ¬¡æƒ…è¯
      
      initFloatSnow();
      animateFloatSnow();
      
      initHeartCanvas();
      initConfetti();
      
      initTimer();
      renderMessages();
      renderWishes();
      
      initDrawingBoard();
      initGame();
      
      // åˆå§‹åŒ–å›¾ç‰‡é¢„è§ˆ
      initImagePreview();
      
      // æ–°å¢åŠŸèƒ½åˆå§‹åŒ–
      createDateProgress();
      createInteractionButtons();
      createThemeToggle();
      
      // æ¸¸æˆæŒ‰é’®ç›‘å¬
      document.querySelector('[data-section="game"]').addEventListener('click', () => {
        setTimeout(startGame, 500);
      });
      
      // æ·»åŠ CSSåŠ¨ç”»å®šä¹‰
      const style = document.createElement('style');
      style.textContent = `
        @keyframes fadeInOut {
          0%, 100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
          20%, 80% { opacity: 1; transform: translateX(-50%) translateY(0); }
        }
      `;
      document.head.appendChild(style);
    }

    // çª—å£å¤§å°å˜åŒ–æ—¶é‡æ–°åˆå§‹åŒ–
    window.addEventListener('resize', () => {
      initFloatSnow();
      initHeartCanvas();
      initConfetti();
      initDrawingBoard();
    });

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    window.addEventListener('load', initPage);
  </script>
</body>
</html>